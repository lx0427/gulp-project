<!DOCTYPE html>
<html>

<head>
    <title>信息反馈</title>
    <% include ../../components/_head.art %>
    <link rel="stylesheet" href="../../css/weui-select.min.css">
<style>

.wx_stars i {background:url(../../images/star.png) 0 0px no-repeat;}
.wrapper {height:25px;}
.wrapper li {float:left;width:25px;height:11px;background:url(../../images/star.png) 0 0px no-repeat; }/*开始默认选中*/
.info_assess_content{
  word-wrap: break-word;
  word-break: break-all;
  overflow: hidden;
}
.hy_xxsb {display: none;}
</style>
</head>

<body>
<article class="wx_layout">
  <header class="wx_infofktop">
      <ul class="hy_xxsb">
    <li class="xxsb_list xxsb_list_checked" onclick="onPage(2);"><span class="typeSpan" style="background:#ffffff;color:#3e7baf;">客户拜访</span></li>
    <li class="xxsb_list" onclick="onPage(3);"><span class="typeSpan" style="">周 报</span></li>
  </ul>
  </header>
  <section class="wx_infofk">
    <div class="bfff toptit">
      <div class="tit">随手记</div>
      <div class="wx_suggest ssjlist" id="contentDiv">
          
      </div>
      <div class="wx_suggest ssjlist" id="contentDiv1">
          
      </div>
      
      <div class="wx_suggest ssjlist" id="main">

      </div>
       <div class="wx_suggest ssjlist" id="main1">

      </div>
    </div>
    <p class="c3d729e history" id="revocation" style="display: none;" onclick="toRevocation()"><i class="iconfont">&#xeab1;</i>撤销</p>
  </section>
</article>
<% include ../../_foot.html %>
<script src="../../js/oauth2.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
    $(function(){
        wxconfig();
    });
</script>
<script src="../informationReport/messageNoteInfo1.js"></script>
<script src="../../lib/swiper.min.js"></script>
<!-- 上报人查看 评分区 -->
<script id="main_page" type="text/html">
  <div class="item">
      <div class="inner">
      {{each list as value i}}
        <div class="cont">
          <ul class="list">
            <li>
              <dl>
                <dt>{{value.receiveUserName}}</dt>
                <dd class="evaluate">
                    <span class="tl">综合评价</span>
                    {{if value.starts==null}}
                      未评论
                    {{/if}}
                    {{if value.starts==1 }}
                    <ul class="wrapper">
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常差</span></li>
                    </ul>    
                    {{/if}}
                     {{if value.starts==2 }}
                    <ul class="wrapper">
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较差</span></li>
                    </ul>    
                    {{/if}}
                     {{if value.starts==3 }}
                    <ul class="wrapper">
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">一般</span></li>
                    </ul>    
                    {{/if}}
                     {{if value.starts==4 }}
                    <ul class="wrapper">
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px -20px;"></li>
                      <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较好</span></li>
                    </ul>  
                    {{/if}}
                     {{if value.starts==5 }}
                    <ul class="wrapper">
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li class="li" style="background-position: 0px 0px;"></li>
                      <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常好</span></li>
                    </ul>    
                    {{/if}}
                </dd>
                {{if value.remartk != null}}
                <p class="info_assess_content">{{value.receiveUserName}} : {{value.remartk}}</p>
                {{/if}}
                {{if value.commentList != null && value.commentList.length>0}}
                {{each value.commentList as item i}}
                <p class="info_assess_content">{{item.userName}} : {{item.content}}</p>
                {{/each}}
                {{/if}}
              </dl>
            </li>
          </ul>
          <div class="reply">
            <div class="box">
              <textarea placeholder="请输入您的内容（不超过300字）" id="remark_{{i}}"></textarea>
            </div>
            <p class="btn">
              <a class="replybtn" href="javascript:void(0)" onclick="saveReply('{{value.pkid}}', '{{i}}', '{{value.starts}}', '{{value.receiveUserId}}', '{{value.reportId}}')">回复</a>
              <a class="cancelbtn" href="javascript:void(0)" onclick="cleanContent('{{i}}')">取消</a>
            </p>
          </div>
        </div>
      {{/each}}
      </div>
    </div>  
</script>

<!-- 接收人查看 评分区 -->
<script id="main1_page" type="text/html">
  <div class="item">
      <div class="inner">
        <div class="cont">
          <ul class="list">
            {{if data.defineComments != null}}
            {{each data.defineComments as item i}}
            <li>
              <dl>
                <dt>{{item.receiveUserName}}{{if item.isRead != null}} {{if item.isRead==1}}<span style="float: right; padding-right: 12%; padding-top: 1px; color: green; font-size: 1.2rem;font-weight: 600;" >已读</span>{{else}}<span style="float: right; padding-right: 12%; padding-top: 1px; color:red ; font-size: 1.2rem;font-weight: 600;" >未读</span>{{/if}}{{/if}}</dt>
               {{if item.starts==null}}
                <div >
                    <span style="float: left;font-size: 1.2rem; padding-top: 2px;">综合评价</span>
                    <span style="float: right; padding-right: 10%; padding-top: 1px; color: #ffad51; font-size: 1.2rem;" >未评分</span>
                  <ul class="wrapper" >
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                  </ul>
                </div>
                {{/if}}
                {{if item.starts==1 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常差</span></li>
                  </ul>    
                  {{/if}}
                   {{if item.starts==2 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较差</span></li>
                  </ul>    
                  {{/if}}
                   {{if item.starts==3 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">一般</span></li>
                  </ul>    
                  {{/if}}
                   {{if item.starts==4 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较好</span></li>
                  </ul>  
                  {{/if}}
                   {{if item.starts==5 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常好</span></li>
                  </ul>    
                  {{/if}}            

                  {{if item.remartk != null}}
                  <p class="info_assess_content">{{item.receiveUserName}} : {{item.remartk}}</p>
                  {{/if}}
                  {{if item.commentList != null && item.commentList.length>0}}
                  {{each item.commentList as itemMx}}
                  <p class="info_assess_content">{{itemMx.userName}} : {{itemMx.content}}</p>
                  {{/each}}
                  {{/if}}
              </dl>
            </li>
            {{/each}}
            {{/if}}
            <!-- 本人评论 -->
            <li>
              <dl>
                <dt>{{data.receiveUserName}}{{if data.isRead != null}}{{if data.isRead==1}}<span style="float: right; padding-right: 12%; padding-top: 1px; color: green; font-size: 1.2rem;font-weight: 600;" >已读</span>{{else}}<span style="float: right; padding-right: 12%; padding-top: 1px; color:red ; font-size: 1.2rem;font-weight: 600;" >未读</span>{{/if}}{{/if}}</dt>
               {{if data.starts==null}}
                <div  id="t_startsNum">
                    <span style="float: left;font-size: 1.2rem; padding-top: 2px;">综合评价</span>
                    <span style="float: right; padding-right: 10%; padding-top: 1px; color: #ffad51; font-size: 1.2rem;" id="evaluateInfo">请打分(最少一颗星)</span>
                  <ul class="wrapper" >
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                  </ul>
                 <input type="hidden" id="startsNum" value="0">
                </div>
                {{/if}}
                {{if data.starts==1 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常差</span></li>
                  </ul>    
                  {{/if}}
                   {{if data.starts==2 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较差</span></li>
                  </ul>    
                  {{/if}}
                   {{if data.starts==3 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">一般</span></li>
                  </ul>    
                  {{/if}}
                   {{if data.starts==4 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px -20px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">较好</span></li>
                  </ul>  
                  {{/if}}
                   {{if data.starts==5 }}
                  <ul class="wrapper">
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li class="li" style="background-position: 0px 0px;"></li>
                    <li style="background: none; width: 70px;"><span style="color: #ffb251;line-height: 0;">非常好</span></li>
                  </ul>    
                  {{/if}}            

                  {{if data.remartk != null}}
                  <p class="info_assess_content">{{data.receiveUserName}} : {{data.remartk}}</p>
                  {{/if}}
                  {{if data.commentList != null && data.commentList.length>0}}
                  {{each data.commentList as item i}}
                  <p class="info_assess_content">{{item.userName}} : {{item.content}}</p>
                  {{/each}}
                  {{/if}}
              </dl>
            </li>
          </ul>
          <div class="reply">
            <div class="box">
              <textarea placeholder="请输入您的内容（不超过300字）" id="remark_{{data.pkid}}"></textarea>
            </div>
            <p class="btn">
              <a class="replybtn" href="javascript:void(0)" onclick="saveReply('{{data.pkid}}', '{{data.pkid}}', '{{data.starts}}', '{{data.receiveUserId}}', '{{data.reportId}}')">回复</a>
              <a class="cancelbtn" href="javascript:void(0)" onclick="cleanContent('{{data.pkid}}')">取消</a>
            </p>
          </div>
        </div>

      </div>
    </div>
</script>

<!-- 上报人查看 内容区 -->
<script id="contentDiv_page" type="text/html">
  <div class="item" style="border-bottom: none;">
    <div class="inner">
      <div class="top">
        <div class="dt ellipsis1" style="padding-right: 0px;"><div style="width: 100%; height: max-content !important;">{{#toTextarea(data.problem)}}</div></div>
        <div class="dd"> {{#getDate(data.cdate,"yyyy-MM-dd HH:mm:ss")}} {{if data.industry!=null}} | {{data.industry}}{{/if}}</div>

        <div class="info_img" style="width:100%;margin-bottom: -15px;">
          <!--图片路径，可能多张,逗号分隔-->
          {{if data.uploadAppendageAddress != null }}
          <ul class="wx_qdphoto wx_cjht" id="img_ul" style="margin-bottom: 10px;">
          {{#getImg(data.uploadAppendageAddress)}} </ul>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</script>

<!-- 接收人查看 内容区 -->
<script id="contentDiv1_page" type="text/html">
  <div class="item" style="border-bottom: none;">
    <div class="inner">
      <div class="top">
        <div class="dt ellipsis1" style="padding-right: 0px;"><div style="width: 100%; height: max-content;">{{#toTextarea(data.informationReports.problem)}}</div></div>
        <div class="dd">{{data.reportUserName}} 
        {{if data.productLine != null}} | {{data.productLine}}{{/if}}{{if data.informationReports.industry!=null}} | {{data.informationReports.industry}}{{/if}}</div>
<div class="dd"> {{#getDate(data.informationReports.cdate,"yyyy-MM-dd HH:mm:ss")}}</div>
        <div class="info_img" style="width:100%;margin-bottom: -15px;">
          <!--图片路径，可能多张,逗号分隔-->
          {{if data.informationReports.uploadAppendageAddress != null }}
          <ul class="wx_qdphoto wx_cjht" id="img_ul" style="margin-bottom: 10px;">
          {{#getImg(data.informationReports.uploadAppendageAddress)}} </ul>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</script>

<!-- 评分 -->

<script type="text/javascript">
function showStartsNum(){
          var array = ["startsNum"];
          if(array.length>0){
            for (var i = 0; i <array.length; i++) {
              var instance = array[i];
              console.log(instance);
              var star = $("#t_"+instance+" > ul > li");
              showStar(star,instance);
            }
          }
        }

  //点击以及改变样式
  function showStar(star,instance){
    var temp = 0;
    for(var i = 0, len = star.length; i < len; i++){//star.length=5
      star[i].index = i;
      star[i].onclick = function(){
        clear();//点击的时候清除样式
        temp = this.index+1;
        $("#"+instance).val(temp);
        current(temp);
      }
    }
    //清除所有
    function clear(){
      for(var i = 0, len = star.length; i < len; i++){
        star[i].style.backgroundPosition = '0 -20px';
      }
    }
    //显示当前第几颗星
    function current(temp){
      if(temp==1){
        $("#evaluateInfo").html("非常差");
      }
      if(temp==2){
        $("#evaluateInfo").html("较差");
      }
      if(temp==3){
        $("#evaluateInfo").html("一般");
      }
      if(temp==4){
        $("#evaluateInfo").html("较好");
      }
      if(temp==5){
        $("#evaluateInfo").html("非常好");
      }
      for(var i = 0; i < temp; i++){
        star[i].style.backgroundPosition = '0 0px';
      }
    }
  };
</script>

</body>
</html>
